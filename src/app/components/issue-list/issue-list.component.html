<app-navigation-bar [title]="'Issues for: ' + requestName">
<fd-toolbar class="toolbar" fdType="transparent" [clearBorder]="true">
  <fd-toolbar-spacer></fd-toolbar-spacer>
  <fd-input-group
    glyph="decline"
    glyphAriaLabel="Clear"
    placeholder="Search"
    [button]="true"
    [disabled]="false"
    [(ngModel)]="searchTerm"
    (ngModelChange)="handleSearchTermChange($event)"
    (addOnButtonClicked)="handleSearchTermChange('')"
  >
  </fd-input-group>
  <button
    fd-toolbar-item
    ariaLabel="Add issue"
    label="Add Issue"
    title="Add issue"
    fd-button
    glyph="add"
    (click)="addIssue(newIssueDialog)"
  ></button>
</fd-toolbar>
<div>
<span></span>
</div>
<ul fd-list [byline]="true" [unreadIndicator]="true">
  @for (issue of displayedIssues; track $index) {
  <li fd-list-item [unread]="true" aria-description="unread" class="{{issue.status}}" (click)="navigateToTaskList(issue.id)">
    <span fd-list-thumbnail><fd-icon glyph="task"></fd-icon></span>
    <div fd-list-content class="{{issue.status}}">
      <div fd-list-title>{{issue.name}}</div>
      <div fd-list-footer class="{{issue.status}}">{{issue.productManager}}</div>
      <div fd-list-byline [twoCol]="true">
        @if(issue.closeDate){
        <div fd-list-byline-left>Opened: {{issue.openDate}}  Closed:  {{issue.closeDate}}</div>
        }
        @else{
          <div fd-list-byline-left>Opened: {{issue.openDate}}</div>
        }
        <div fd-list-byline-right>{{issue.doneTasksCount}}/{{issue.tasksCount}}</div>
      </div>
    </div>
    @if(issue.status === 'OPEN'){
    <button fd-button fdType="transparent" glyph="accept" (click)="closeIssue(issue.id); $event.stopPropagation()" title="close"></button>
    <button fd-button fdType="transparent" glyph="sys-cancel-2" (click)="abandonIssue(issue.id); $event.stopPropagation()" title="abandon"></button>
    }
  </li>
  }
</ul>
<ng-template [fdDialogTemplate] let-dialog let-dialogConfig="dialogConfig" #newIssueDialog>
  <fd-dialog [dialogConfig]="dialogConfig" [dialogRef]="dialog">
    <fd-dialog-header>
      <h1 fd-title>New Item</h1>
      <button fd-dialog-close-button (click)="dialog.dismiss('Close button')"></button>
    </fd-dialog-header>
    <fd-dialog-body>
      <form [formGroup]="myForm">
        <div fd-form-set>
          <div fd-form-item>
            <label fd-form-label for="input-1">Name</label>
            <input
              fd-form-control
              formControlName="nameInput"
              type="text"
              id="input-1"
              autocomplete="off"
            />
          </div>
          <div class="fd-row fd-form-item">
            <div class="fd-col">
              <label class="fd-form-label" for="text-2434-name">Description:</label>
            </div>
            <div class="fd-col">
                <textarea class="fd-textarea" id="text-2434-name"
                          formControlName="descriptionInput">textarea</textarea>
            </div>
          </div>
          <div fd-form-item>
            <label fd-form-label for="input-4">Product Manager</label>
            <input
              fd-form-control
              formControlName="productManagerInput"
              type="text"
              id="input-4"
              autocomplete="off"
            />
          </div>
        </div>
      </form>
    </fd-dialog-body>
    <fd-dialog-footer>
      <fd-button-bar fdType="emphasized" label="Save" type="submit" (click)="dialog.close('Save')">
      </fd-button-bar>
      <fd-button-bar label="Cancel" (click)="dialog.dismiss('Cancel')"></fd-button-bar>
    </fd-dialog-footer>
  </fd-dialog>
</ng-template>
</app-navigation-bar>
